{% load static %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Resume — Screenshot Style Template</title>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;700&family=Open+Sans:wght@300;600;700&display=swap" rel="stylesheet">
  <style>
     :root{
      --accent:#7f7a66;
      --muted:#222;
      --body-bg:#f8f6f1;
      --paper:#ffffff;
      --line:#151515;
    }
    *{box-sizing:border-box}
    html,body{
      margin:0;
      background:var(--body-bg);
      font-family:'Open Sans';
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
    }

    /* ===== DOWNLOAD BAR ===== */
    .download-bar{
      max-width:820px;
      margin:20px auto 0;
      display:flex;
      justify-content:flex-end;
    }
    .download-bar button{
      padding:10px 18px;
      background:#2b3444;
      color:#fff;
      border:2px solid #1a202c;
      border-radius:8px;
      font-size:14px;
      font-weight:600;
      cursor:pointer;
    }

    /* ===== PAGE ===== */
    .page-wrap{
      max-width:820px;
      margin:16px auto 36px;
      padding:28px;
      background:var(--paper);
     
    }

    .cv-header{background:#e9e7e0;padding:26px 28px;text-align:center}
    .name{font-family:'Merriweather';font-weight:700;letter-spacing:2px;font-size:28px;color:var(--accent)}
    .name b{color:#1b1b1b}
    .contact{font-size:12px;margin-top:8px}

    .section{padding:18px 0}
    .section+.section{border-top:1px solid rgba(0,0,0,0.07)}
    .section-title{
      font-family:'Merriweather';
      color:var(--accent);
      font-size:20px;
      margin:0 0 10px;
      padding-bottom:6px;
      font-weight:700
    }
    .section-title::after{
      content:'';
      height:3px;
      background:#000;
      opacity:0.2;
      display:block;
      margin-top:8px
    }

    .job{margin:14px 0}
    .job .meta{font-size:13px;color:#555;margin:4px 0}
    .edu b{display:block;padding-left:20px;position:relative}
    .edu b::before{content:"•";position:absolute;left:0;color:var(--accent)}
    .lang-row{display:flex;gap:15px;font-size:14px;margin:6px 0}
    .edu .small{
  font-size:15px;
  color:#333;
  line-height:1.7;
}

    /* ===== PDF PAGE BREAK FIX ===== */
@media print {

  /* page break vachina tharvatha content ki top space */
  .html2pdf__page-break + * {
    margin-top: 25px !important;
    padding-top: 15px !important;
  }

  /* sections page bottom lo cut avvakunda */
  .section {
    page-break-inside: avoid;
  }

  /* paragraph, job blocks safe ga break avvadaniki */
  p, .job, .edu, ul, li {
    page-break-inside: avoid;
  }
}

  </style>
</head>

<body>
<!-- ===== DOWNLOAD BUTTON ===== -->
<div class="download-bar">
  <button onclick="downloadPDF()">Download PDF</button>
</div>

<!-- ===== RESUME ===== -->
<div class="page-wrap" id="resumeRoot">


<header class="cv-header">
  <div class="name"><span id="firstName"></span> <b id="lastName"></b></div>
  <div class="contact" id="contact"></div>
</header>

<main>

<section class="section" id="summarySection">
  <h2 class="section-title">Professional Summary</h2>
  <p id="profileSummary"></p>
</section>

<section class="section" id="publicLinksSection">
  <h2 class="section-title">Public Links</h2>
  <ul id="publicLinksList"></ul>
</section>

<section class="section" id="experienceSection">
  <h2 class="section-title">Experience</h2>
  <div id="experienceContainer"></div>
</section>

<section class="section" id="educationSection">
  <h2 class="section-title">Education</h2>
  <div id="educationContainer"></div>
</section>

<section class="section" id="skillsSection">
  <h2 class="section-title">Skills</h2>
  <ul id="skillsList"></ul>
</section>

<section class="section" id="projectsSection">
  <h2 class="section-title">Projects</h2>
  <div id="projectsContainer"></div>
</section>

<section class="section" id="certificationsSection">
  <h2 class="section-title">Certifications</h2>
  <ul id="certificationsList"></ul>
</section>

<section class="section" id="internshipsSection">
  <h2 class="section-title">Internships</h2>
  <div id="internshipsContainer"></div>
</section>

<section class="section" id="achievementsSection">
  <h2 class="section-title">Achievements</h2>
  <ul id="achievementsPreview"></ul>
</section>

<section class="section" id="hobbiesSection">
  <h2 class="section-title">Hobbies / Interests</h2>
  <ul id="hobbiesList"></ul>
</section>

<section class="section" id="languagesSection">
  <h2 class="section-title">Languages</h2>
  <div class="languages" id="languagesContainer"></div>
</section>

<section class="section" id="additionalInfoSection">
  <h2 class="section-title">Additional Information</h2>
  <p id="additionalInfo"></p>
</section>

<section class="section" id="declarationSection">
  <h2 class="section-title">Declaration</h2>
  <p id="declarationText"></p>
</section>

</main>
</div>
<!-- ===== PDF LIBRARY ===== -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script>
/* ================== PDF DOWNLOAD ================== */
function downloadPDF(){
  const element = document.getElementById("resumeRoot");

  const opt = {
    margin:       [20, 15, 20, 15],
    filename:     'resume_template6.pdf',
    image:        { type: 'jpeg', quality: 1 },
    html2canvas:  {
      scale: 2,
      useCORS: true,
      backgroundColor: "#ffffff"
    },
    jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' }
  };

  html2pdf().set(opt).from(element).save();
}
</script>
<script>

const data = JSON.parse(localStorage.getItem("resumeData") || "{}");

/* PERSONAL INFO */
if (data.personalInfo) {
  if (data.personalInfo.fullName) {
    const parts = data.personalInfo.fullName.trim().split(" ");
    firstName.innerText = parts[0] || "";
    lastName.innerText = parts.slice(1).join(" ");
  }

  let ct="";
  if(data.personalInfo.location) ct+=data.personalInfo.location;
  if(data.personalInfo.phone) ct+=(ct?" — ":"")+data.personalInfo.phone;
  if(data.personalInfo.email) ct+=(ct?" — ":"")+data.personalInfo.email;
  contact.innerText=ct;

  if(data.personalInfo.summary)
    profileSummary.innerText=data.personalInfo.summary;
}

/* PUBLIC LINKS */
let pubHTML="";
if(data.publicLinks){
  if(data.publicLinks.github)
    pubHTML+=`<li><b>GitHub:</b> <a href="${data.publicLinks.github}" target="_blank">${data.publicLinks.github}</a></li>`;

  if(data.publicLinks.linkedin)
    pubHTML+=`<li><b>LinkedIn:</b> <a href="${data.publicLinks.linkedin}" target="_blank">${data.publicLinks.linkedin}</a></li>`;

  if(data.publicLinks.portfolio)
    pubHTML+=`<li><b>Portfolio:</b> <a href="${data.publicLinks.portfolio}" target="_blank">${data.publicLinks.portfolio}</a></li>`;

  if(data.publicLinks.website)
    pubHTML+=`<li><b>Website:</b> <a href="${data.publicLinks.website}" target="_blank">${data.publicLinks.website}</a></li>`;

  if(Array.isArray(data.publicLinks.custom)){
    data.publicLinks.custom.forEach(link=>{
      const n=link.name||link.linkName;
      const u=link.url||link.linkUrl;
      if(n&&u) pubHTML+=`<li><b>${n}:</b> <a href="${u}" target="_blank">${u}</a></li>`;
    });
  }
}
publicLinksList.innerHTML=pubHTML;

/* EXPERIENCE */
if(data.experience){
  experienceContainer.innerHTML=data.experience.map(exp=>`
    <div class="job">
      <div class="job-head"><b>• ${exp.jobTitle||""}</b> ${exp.company?" — "+exp.company:""}</div>
      <div class="meta">${exp.startDate||""} — ${exp.current?"Present":exp.endDate||""}</div>
      <p>${exp.description||""}</p>
    </div>
  `).join("");
}

/* EDUCATION */
if(data.education){
  educationContainer.innerHTML=data.education.map(edu=>`
    <div class="edu">
      <div class="job-head">
        <strong>• ${edu.degree || edu.course || ""}</strong>${edu.institution ? " — " + edu.institution : ""}
      </div>
      <div class="edu-meta">${edu.startDate||""} — ${edu.current?"Present":edu.endDate||""}</div>
      <p class="small">
        ${edu.score ? `${edu.scoreType || ""}: ${edu.score}<br>` : ""}
        ${edu.description||edu.details||""}
      </p>
    </div>
  `).join("");
}



/* LANGUAGES */
if(data.languages){
  languagesContainer.innerHTML=data.languages.map(l=>`
    <div class="lang-row">
      <div><b>•</b> ${l.name}</div>
      <div>: ${l.level}</div>
    </div>
  `).join("");
}

/* SKILLS */
if(data.skills){
  skillsList.innerHTML=data.skills.map(s=>{
    if(typeof s==="string") return `<li>${s}</li>`;
    return `<li><b>${s.name||s.skill||""}</b> ${s.category?`(${s.category})`:""} ${s.level?`— ${s.level}`:""}</li>`;
  }).join("");
}

/* PROJECTS */
if(data.projects){
  projectsContainer.innerHTML=data.projects.map(p=>{
    const url=p.projectURL||p.projectUrl||p.url||"";
    return `
    <div class="job">
      <b>• ${p.projectName||p.name||""}</b>
      <div class="meta">${p.startDate||""} — ${p.endDate||""}</div>
      ${url?`<div class="meta"><b>URL:</b> <a href="${url}" target="_blank">${url}</a></div>`:""}
      <p>${p.description||""}</p>
    </div>`;
  }).join("");
}

/* CERTIFICATIONS */
if(data.certifications){
  certificationsList.innerHTML=data.certifications.map(cert=>{
    let html=`<li style="margin-bottom:10px;"><b>${cert.name}</b>`;
    if(cert.issuer) html+=` — ${cert.issuer}`;
    if(cert.date) html+=` (${cert.date})`;
    if(cert.id) html+=`<br><small>ID: ${cert.id}</small>`;
    if(cert.url) html+=`<br><small>Link: <a href="${cert.url}" target="_blank">${cert.url}</a></small>`;
    if(cert.description) html+=`<br><small>${cert.description}</small>`;
    return html+"</li>";
  }).join("");
}

/* INTERNSHIPS */
if(data.internships){
  internshipsContainer.innerHTML=data.internships.map(i=>`
    <div class="job">
      <div class="job-head">
<b>• ${(i.internshipName || i.internshipTitle || i.title || i.name || "").replace(/^:\s*/, "")}</b>
        ${i.organization || i.company ? " — " + (i.organization || i.company) : ""}
      </div>
      <div class="meta">${i.startDate||""} — ${i.current?"Present":i.endDate||""}</div>
      <p>${i.description||""}</p>
    </div>
  `).join("");
}

/* ACHIEVEMENTS */
if(data.achievements){
  achievementsPreview.innerHTML=data.achievements.map(a=>`
    <li>${typeof a==="string"?a:(a.achievement||a.name||"")}</li>
  `).join("");
}

/* HOBBIES */
if(data.hobbies){
  hobbiesList.innerHTML=data.hobbies.map(h=>`
    <li>${typeof h==="string"?h:h.hobby}</li>
  `).join("");
}

/* ADDITIONAL INFO */
additionalInfo.innerText=data.additionalInfo||"";

/* DECLARATION */
declarationText.innerText=data.declaration||"";

/* AUTO HIDE SECTIONS */
function hideIfEmpty(id, val){
  if(!val || val.length===0 || val.trim==="") 
    document.getElementById(id).style.display="none";
}

hideIfEmpty("summarySection", profileSummary.innerText);
hideIfEmpty("publicLinksSection", publicLinksList.innerHTML);
hideIfEmpty("experienceSection", data.experience);
hideIfEmpty("educationSection", data.education);
hideIfEmpty("skillsSection", data.skills);
hideIfEmpty("projectsSection", data.projects);
hideIfEmpty("certificationsSection", data.certifications);
hideIfEmpty("internshipsSection", data.internships);
hideIfEmpty("achievementsSection", data.achievements);
hideIfEmpty("hobbiesSection", data.hobbies);
hideIfEmpty("languagesSection", data.languages);
hideIfEmpty("additionalInfoSection", additionalInfo.innerText);
hideIfEmpty("declarationSection", declarationText.innerText);

</script>

</body>
</html> 